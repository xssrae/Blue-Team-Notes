---
tags:
  - MALWARE-ANALISYS
  - LetsDefend
---
# O que devemos prestar atenção quando realizamos uma análise dinâmica?

Mencionamos que a análise dinâmica é o método que nós realmente ==executamos o malware em nosso próprio sistema e analisamos suas atividades no sistema operacional==.

O que fazer depois de executar o malware? Vamos executá-lo e apenas assistir a tela?

Neste artigo, falaremos sobre os passos que você deve seguir após a execução do malware.

## **Atividades de processo**

Quando o malware é executado, ele cria um **processo próprio** como outros aplicativos. Todas as operações no sistema operacional são realizadas através de um processo. Antes de seguir outras atividades, devemos detectar os *processos pertencentes ao malware*.

Um grande número de atividades de processo, rede, registro e arquivo ocorre dentro do sistema operacional. Como pode não ser possível analisar todas essas atividades, podemos começar a analisar as atividades dos processos de malware para ver se podemos encontrar algo sólido sobre suas atividades.

Ao examinar um processo, deve-se prestar especial atenção às informações, como se ela cria um novo processo infantil, as DLLs importa e qual usuário é administrado.

Você pode usar um aplicativo chamado **Process Hacker** para examinar processos.

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-47.png)


==O malware pode se *injetar em diferentes processos*, realizar atividades para seus próprios fins com a vida dos binários de terra== ou fazer com que aplicativos legítimos executem seus próprios aplicativos. Por estas razões, as atividades de todos os processos pertencentes ao malware e utilizados pelo malware devem ser analisadas.

Por exemplo, digamos que o malware se injeta no processo notepad.exe depois de ser executado. Neste caso, *precisamos examinar todas as atividades que o notepad.exe criou desde o momento em que foi injetado*.

Tópicos como a Injeção de Processos serão discutidos nos treinamentos de análise de malware.

---
## **Atividades em rede**

O malware geralmente estabelece uma conexão de rede para baixar a segunda carga útil, para se comunicar com comando e controle (c2), para pular para outros dispositivos na rede, para roubar dados.

No final da nossa análise de malware, precisamos detectar essas conexões de rede, aprender como o malware se comunica e relatar essas atividades de rede.

O Wireshark é um software que pode atender a todas as suas necessidades para analisar as atividades da rede. No entanto, você pode escolher ferramentas como o **Fiddler**, nos casos em que você sabe que o malware se comunica especialmente através do protocolo HTTP (o Malware se comunica principalmente por protocolos como HTTP, SMTP).

---
## **Atividades de registro**

Nós mencionamos Registros no tutorial do Windows. Mais rapidamente, os registros são bancos de dados hierárquicos que são usados para armazenamento de dados em sistemas operacionais Windows. É usado por invasores para fins como roubar dados e garantir persistência.

O Windows mantém os aplicativos para executar quando o sistema operacional é iniciado em algumas chaves de registro. Os atacantes visam garantir a persistência aproveitando esse recurso do sistema operacional e adicionando seu próprio software malicioso a essas chaves de registro.

Algumas dessas chaves de registro;

- HKEY_CURRENT_USER?Software-Microsoft-Windows-Windows'Current'Run
- HKEY_CURRENT_USER?Software-Microsoft-Windows-Windows-CurrentVersion
- HKEY_LOCAL_MACHINE?Software-Microsoft-Windows-Windows-CurrentVersão
- HKEY_LOCAL_MACHINE-Software-Microsoft-Windows-Windows-Resion-RunOnce

Como os registros também são usados muito por processos normais, você precisa analisar especificamente as alterações de registro feitas por processos de software maliciosos.

Ao usar o aplicativo chamado Regshot, você pode detectar as alterações que o malware fez no Registro.

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-48.png)

Antes de executar o malware, você pode executar Regshot e clicar no botão "1st shot" para permitir que o Regshot colete registros existentes.

Em seguida, você deve pressionar o botão "2nd shot" para obter uma nova foto depois de executar o malware e permitir algum tempo para mostrar atividade. Você pode ver as diferenças entre essas duas fotos do Regshot pressionando o botão “Comparar”.

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-49-1024x517.png)

---
## **Atividades de Arquivos**

O malware realiza atividades de arquivo no sistema operacional por muitas razões. Recentemente, os invasores desenvolveram um malware sem arquivo para impedir a detecção.

No Windows, há um diretório chamado "Temp" onde os arquivos temporários estão localizados. Os aplicativos geralmente usam esse diretório para hospedar seus arquivos voláteis. O malware geralmente se copia para o diretório Temp. Por esta razão, você deve prestar atenção especial às atividades realizadas neste diretório.

Você pode acessar este diretório pressionando a combinação de chave **“War +** R” e digitando o seguinte comando depois:

- **%TEMP%**

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-50.png)

Para garantir a persistência, o malware também copia-se para o diretório Startup, que contém aplicativos que serão executados automaticamente quando o sistema operacional for iniciado. Você deve prestar atenção especial às atividades realizadas nesses diretórios.

Você pode acessar este diretório pressionando a combinação de chave **“War +** R” e digitando o seguinte comando depois:

- **shell:startup (embragem)**
- **shell: startup comum**

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-51.png)

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-52.png)

![](https://letsdefend.io/blog/wp-content/uploads/2022/07/image-53.png)
