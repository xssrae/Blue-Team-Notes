---
tags:
  - MALWARE-ANALISYS
  - LetsDefend
---

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash1.png)

  
>**Nota:** As funções Hash são um assunto amplo dentro do campo da criptologia. Embora este curso forneça uma visão geral das funções de hash, ele não se aprofunda no tópico extensivamente. Em vez disso, o foco aqui é explicar as funções hash e seu uso em termos de análise de malware estático. Para saber mais sobre as funções hash, você pode acessar o treinamento relacionado a partir do link: [**Introdução à Criptologia**](https://app.letsdefend.io/training/lessons/introduction-to-cryptography)
## **Encontrando o hash do arquivo com a ferramenta**

 Ao *pesquisar* o valor hash de um arquivo em bancos de dados de assinatura bem conhecidos, é possível ==determinar se o malware foi analisado anteriormente e obter os resultados de análise correspondentes.== No entanto, é essencial notar que, se um malware recém-adquilo não tiver uma análise preliminar, nenhum relatório de análise pode ser acessado usando seu valor de hash.

Esta seção do treinamento demonstra vários métodos para calcular o valor hash de um arquivo de malware.

Existem várias ferramentas usadas para calcular o hash de um arquivo. Por exemplo, abaixo " **HashCalc"** é usado para calcular o valor de hash do malware.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash2.png)


Quando a ferramenta HashCalc é iniciada, ela aparece como mostrado na imagem acima. É possível calcular tanto os valores de hash de arquivos quanto os valores de hash de textos através da ferramenta HashCalc. Para fazer isso, a opção apropriada no campo **"Formato de dados"** localizada no canto superior esquerdo deve ser escolhida. **"Arquivo"** como opção de formato de dados deve ser selecionado:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash3.png)

Depois de selecionar o formato de dados, o arquivo de malware é fornecido à ferramenta para cálculo de hash.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash4.png)


Depois de selecionar o algoritmo hash desejado para o cálculo de hash usando HashCalc como no exemplo acima, os valores de hash são calculados clicando no botão " **Calcular** " localizado na parte inferior direita da ferramenta.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash5.png)


Como pode ser visto, hash do malware foi calculado com sucesso para várias funções hash. Embora a ferramenta "HashCalc" demonstrada acima seja bastante útil no cálculo do hash de arquivos individuais, ela pode não lidar com valores de hash para vários arquivos simultaneamente. Nesses casos, ferramentas alternativas como **"HashTools"** são mais adequadas para calcular o hash de vários arquivos.

 Quando HashTools é inicialmente lançado, ele aparecerá como o seguinte:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash6.png)

Os arquivos cujo hash será calculado são adicionados à ferramenta com a ajuda dos botões na parte superior esquerda da janela vista na imagem acima. Depois que os arquivos são adicionados, o cálculo do hash pode ser realizado de acordo com o algoritmo de hash desejado com a ajuda dos botões na parte inferior da janela.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash7.png)


Como visto na imagem acima, os valores de hash dos arquivos foram calculados com sucesso de acordo com o algoritmo de hash MD5. Com esta ferramenta, o hash de vários arquivos pode ser calculado rapidamente.

As seguintes ferramentas em execução no Windows também podem ser usadas para encontrar o hash do arquivo:

**HashMyFiles** : [https://www.nirsoft.net/utils/hash_my_files.html](https://www.nirsoft.net/utils/hash_my_files.html) **(**[em seu perfil)](https://www.nirsoft.net/utils/hash_my_files.html)

**QuickHash** : [https://www.quickhash-gui.org/](https://www.quickhash-gui.org/)

## **Obtendo o hash do arquivo através de Powershell**

Em certos cenários, pode ser necessário calcular hashes de arquivo através da linha de comando. No Windows, os hashes de arquivo podem ser facilmente calculados usando o Powershell. Por exemplo, vamos calcular o hash do malware usando Powershell:

```powershell
Get-FileHash .\arquivo.exe | Format-List
```


![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash8.png)

O comando pode funcionar com apenas um único parâmetro, que é o nome do arquivo. Por padrão, o cálculo é executado usando a função hash SHA256. Se for necessária uma função hash diferente, o parâmetro **"-Algorithm"** deve ser adicionado. Como uma instância disso, vamos calcular o hash do mesmo arquivo de malware usando a função hash MD5.

```powershell
Get-FileHash .\arquivo.exe  -Algorithm MD5 | Format-List
```

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash9.png)

Como na imagem acima, o cálculo de hash para a função hash MD5 foi realizado com sucesso.
## **Informações Reunindo com arquivo Hash**

A seção anterior demonstrou o processo de cálculo do hash de um arquivo de malware. Nesta parte do treinamento, os vários recursos que podem ser utilizados para coletar informações sobre malware são introduzidos usando o valor do hash. A seguinte lista de recursos pode ser usada para coletar informações sobre o malware usando o File Hash:

- **VirusTotal** : [https://www.virustotal.com/gui/home/search](https://www.virustotal.com/gui/home/search)
- **AnyRun** : [https://app.any.run/submissions/](https://app.any.run/submissions/)
- **Joe Sandbox** : [https://www.joesandbox.com/.](https://www.joesandbox.com/#windows)
- **Análise Híbrida** : [https://www.hybrid-analysis.com/](https://www.hybrid-analysis.com/)
- **MetaDefender** : [https://metadefender.opswat.com/](https://metadefender.opswat.com/)
- **EchoTrail** : [https://www.echotrail.io/](https://www.echotrail.io/)
- **Intezer** : [https://analyze.intezer.com/scan](https://analyze.intezer.com/scan)
- **FileScan.IO** : [https://www.filescan.io/scan](https://www.filescan.io/scan)
- **InQuest Labs** : [https://labs.inquest.net/dfi/search/hash/sha256](https://labs.inquest.net/dfi/search/hash/sha256)
- **Manalyzer** : [https://manalyzer.org/](https://manalyzer.org/)
- **SandboxPikkerEE** : [https://sandbox.pikker.ee/](https://sandbox.pikker.ee/)
- **Yomi** : [https://yomi.yoroi.company/upload](https://yomi.yoroi.company/upload)

#### **Virus Total**
O VirusTotal é uma das fontes proeminentes para pesquisar hashes de malware e acessar relatórios de análise disponíveis. A imagem da página é a seguinte:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash10.png)


O relatório de análise atual pode ser acessado pesquisando o hash na seção de pesquisa vista na imagem acima. Por exemplo, o relatório de análise de um malware é o seguinte:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/7.File+Hash/file-hash11.png)
