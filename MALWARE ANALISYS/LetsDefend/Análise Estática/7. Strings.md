---
tags:
  - MALWARE-ANALISYS
  - LetsDefend
---
## **O que é uma String?**

Uma **string** é um tipo de *variável* que é incluída no código fonte do software. Este tipo de variável consiste em **cadeias de caracteres** que geralmente são feitas de palavras significativas ou grupos de palavras. Por exemplo, o seguinte código fonte C- contém variáveis de tipo string:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string1.png)

## **Importância da análise de strings

Aqui estão alguns exemplos da informação que pode ser derivada de Strings

- **Nomes de arquivo**: As strings podem conter os ==nomes dos arquivos direcionados ou usados no sistema operacional==. Saber quais arquivos no sistema são direcionados e usados pode fornecer informações importantes sobre o comportamento do malware.

- **Caminhos de arquivo**: As strings dentro do código de malware podem incluir ==informações de caminho sobre os arquivos utilizados pelo malware==. Conhecer o diretório em que o malware opera pode agilizar o processo de análise e reduzir o tempo necessário. 

- **Endereços IP**: As strings podem conter endereços IP em formato legível. Esses endereços IP podem corresponder ao servidor Command & Control (C2) com o qual o malware se comunica para receber comandos.

- **Nomes de domínio**: O malware pode ==tentar exfiltrar dados da rede usando o protocolo DNS==. 

- **Endereços de URL**: O malware pode ==baixar arquivos ou recuperar as informações necessárias da Internet, ou da mesma forma, pode usar um endereço URL para exfiltrar dados da rede==.

- **Nomes de produto de segurança**: As cordas podem conter os nomes das soluções de segurança: ==IDS, antivírus e EDR==. Para ocultar seu comportamento no sistema comprometido, ==o malware pode verificar se existe uma solução de segurança no sistema operacional==. Pode ou não realizar suas operações em conformidade. Se um método de evasão de solução de segurança estiver disponível, ele poderá aplicar e continuar suas operações no sistema.

- **Referências de criptografia**: As strings podem incluir os nomes das bibliotecas de criptografia. A presença de tais nomes de bibliotecas em strings ==sugere que o malware pode executar operações de criptografia==. Por exemplo, um ransomware pode criptografar arquivos. 

- **Informações sobre a API do Windows**: O malware pode usar bibliotecas do Windows para executar operações no sistema. Por exemplo, ==o invasor pode tentar se conectar remotamente ao sistema através da sessão iniciada pelo malware e gerenciar o sistema a partir da interface gráfica==. As bibliotecas do Windows podem ser empregadas para determinar a presença ou ausência de atividade do usuário na tela ou para monitorar atividades semelhantes do sistema.

- **Dados codificados com base64**


**Introdução à Criptologia** : [https://app.letsdefend.io/training/lesson_detail/base64-codingdecoding](https://app.letsdefend.io/training/lesson_detail/base64-encodingdecoding)

## **Analisando as strings ofuscadas

Analisar as sequências de malware é geralmente um processo simples. No entanto, identificar os valores específicos dentro das strings que fornecem informações cruciais sobre o malware pode ser um desafio. A saída de string pode ser longa, facilitando o uso de strings importantes. Recomenda-se realizar uma análise orientada a alvo aplicando determinados métodos de pesquisa. Ferramentas de linha de comando ou ferramentas com interface gráfica do usuário (GUI) podem ser usadas ao analisar strings.
#### Linha de comando**

';

;l'
[Strings](https://learn.microsoft.com/en-us/sysinternals/downloads/strings)

Vamos examinar as strings de um malware da linha de comando:

```powershell
strings64.exe -accepteula malwr3.exe | more
```

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string2.png)

Como visto na imagem acima, a linha de comando é aberta no diretório onde a ferramenta de cadeias está localizada e as strings do malware chamado "malwr3.exe" são exibidas com sucesso.

**Nota:** Ao usar a ferramenta strings pela primeira vez, o contrato de usuário deve ser confirmado com o parâmetro **"-accepteula",** caso contrário, a ferramenta não funcionará.

Vamos passar para analisar as strings:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string3.png)
  
Como visto na imagem acima, um endereço IP é identificado na saída de strings. Este endereço IP pode ser o endereço IP do servidor Command & Control (C2) a partir do qual o malware recebe comandos ou um endereço IP ao qual estabelece conexões.

#### **Analisando escondidas com GUI**

Examinar strings pode ser alcançado com a ferramenta "Bintext", que tem uma interface gráfica de usuário (GUI) em vez da linha de comando. 

[Bintext](https://www.portablefreeware.com/index.php?id=2506#:~:text=BinText%20is%20a%20file%20text,as%20well%20as%20Resource%20strings)

Vamos ver as strings do malware no exemplo anterior com o bintext como uma instância:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string4.png)


Ao iniciar a ferramenta Bintext, a interface exibida é semelhante à imagem acima. Podemos proceder fornecendo o malware para a ferramenta Bintext e examinar suas strings.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string5.png)

Como na imagem acima, primeiro, o malware é carregado no programa usando o botão "Browse" e, em seguida, as cadeias de caracteres são exibidas com o botão "Go". Vamos prosseguir com um exame mais aprofundado da cadeia de caracteres:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/8.Strings+Analysis/string6.png)

Como visto na imagem acima, as informações do endereço IP foram exibidas com sucesso com a ferramenta de texto bintext. O valor desejado pode ser pesquisado a partir da seção na parte inferior direita da janela.