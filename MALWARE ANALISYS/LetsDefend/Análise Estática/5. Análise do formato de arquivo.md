---
tags:
  - MALWARE-ANALISYS
  - LetsDefend
---
## **O que é o formato de arquivo?**

Os arquivos têm sua própria estrutura. Cada tipo de arquivo diferente tem um número e comprimento diferentes de campos. Os sistemas operacionais exigem conhecimento deste formato de arquivo para ler corretamente os arquivos.

## **Cabeçalho de arquivo**

O campo "**magic bytes**" no cabeçalho do arquivo é um campo que consiste nos ==poucos bytes iniciais do arquivo e fornece insights sobre o tipo de arquivo==. Em outras palavras, bytes mágicos é a assinatura do arquivo.

Para acesso às assinaturas e extensões de vários tipos de arquivos, você pode visitar o seguinte endereço:

**Lista de Assinaturas de Arquivos** : [https://pt.wiki.org/wiki/List_of_file_signatures](https://en.wikipedia.org/wiki/List_of_file_signatures)

As ferramentas "Hex Editor" podem ser utilizadas para examinar o cabeçalho do arquivo e os campos de bytes mágicos. Por exemplo, a imagem abaixo demonstra os cabeçalhos de arquivo de arquivos executáveis do Windows (PE file).


![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format1.png)
 

O seguinte endereço pode ser usado para examinar as imagens que mostram os cabeçalhos de arquivos com diferentes formatos de arquivo:

**Formatos de arquivo** : [https://github.com/corkami/pics/blob/master/binary/README.md](https://github.com/corkami/pics/blob/master/binary/README.md)

## **Extensões do arquivo**

Uma extensão de arquivo é um apêndice adicionado ao final do nome do arquivo que fornece informações sobre o formato do arquivo. Normalmente, cada tipo de arquivo diferente tem sua própria extensão. Por exemplo, ".html" é a extensão para páginas da web que contêm código HTML. Abaixo estão as estatísticas sobre as extensões de arquivo mais comumente usadas por malware em 2020:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format2.png)

(Fonte da imagem: [https://www.statista.com/statistics/1238996/top-malware-by-file-type/](https://www.statista.com/statistics/1238996/top-malware-by-file-type/) )
## **Tipo de arquivo e extensão de arquivo Mismatch**

Normalmente, a extensão de arquivo fornece informações precisas sobre o formato de arquivo. No entanto, em certos casos,==os atacantes podem enganar seus alvos disfarçando a extensão e executar com sucesso seus ataques. Por exemplo, o arquivo na imagem abaixo parece ser um arquivo "PDF" olhando para sua extensão==.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format3.png)

No entanto, a opção **"extensões de identificação de arquivo"** no Windows deve ser ativada para descobrir se este é realmente um arquivo PDF.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format4.png)

Como pode ser visto na imagem acima, não pode ser definitivamente concluído que o arquivo é um arquivo PDF, uma vez que a opção para exibir extensões de arquivo não está habilitada. Ao ativar esse recurso, vamos ver a extensão do arquivo:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format5.png)


A imagem acima mostra que a extensão real do arquivo é ".exe".
## **Thumbnail Faking**

Além do método descrito no tópico anterior, os atacantes também podem ==modificar a imagem em miniatura associada ao arquivo para melhorar a eficácia do ataque==. Ao fazer isso, eles não só escondem a extensão de arquivo real, mas também impedem o usuário de aprender o formato de arquivo real. Por exemplo, no exemplo anterior, a miniatura do arquivo revela que não é um arquivo PDF, mas sim um arquivo executável do Windows.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format6.png)

No entanto, ao visualizar o arquivo como mostrado na imagem acima, é fácil confundê-lo inicialmente com um arquivo P

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format7.png)


Ao ativar a opção para exibir extensões de arquivo, torna-se evidente que o arquivo em questão não é um arquivo PDF, mas sim um arquivo com a extensão ".exe".
## **Identificação automatizada**

A ferramenta "DROID", que é executada no sistema operacional Windows e tem uma interface gráfica de usuário (GUI), é uma das ferramentas usadas para detectar tipos de arquivos. Você pode acessar a ferramenta DROID no endereço abaixo:

[DROID](https://www.nationalarchives.gov.uk/information-management/manage-information/preserving-digital-records/droid/)
Quando a ferramenta DROID é inicialmente iniciada, uma guia semelhante à mostrada abaixo é exibida:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format8.png)

Os arquivos a serem analisados são fornecidos à ferramenta através do botão **"Adicionar".**

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format9.png)

Uma vez adicionados os arquivos, o processo é iniciado e os resultados são vistos clicando no botão **"Iniciar".**

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format10.png)

Como demonstrado na imagem acima, as informações do formato de arquivo dos arquivos são obtidas com sucesso.

**Identificação de Tipo de Arquivo com Serviços Web Online**

Na análise de malware estático, é possível usar serviços da web on-line para determinar o tipo de arquivo do malware. 

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format11.png)

Existem vários endereços da Web usados para identificar o tipo de arquivo. Alguns desses endereços estão listados abaixo:

- [http://www.detectfiletype.com/](http://www.detectfiletype.com/)
- [https://filext.com/](https://filext.com/)
- [https://filetypechecker.com/](https://filetypechecker.com/)
- [https://www.sisik.eu/arquivo](https://www.sisik.eu/file)
- [https://www.aconvert.com/analyze.html](https://www.aconvert.com/analyze.html)
- [https://www.checkfiletype.com/](https://www.checkfiletype.com/)
- [https://www.toolsley.com/file.html](https://www.toolsley.com/file.html)

## **Manualmente**

Você pode acessar a ferramenta hexade Editor chamada "HxD" vista na imagem abaixo do seguinte endereço:

**HxD** : [https://mh-nexus.de/pt/hxd/](https://mh-nexus.de/en/hxd/)

Por exemplo, a assinatura de um arquivo executável do Windows é mostrada abaixo no editor hexado Editor:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/6.File+Format+Analysis/format12.png)

Como observado na imagem fornecida, a assinatura do arquivo foi detectada usando o editor hex, levando à identificação do arquivo como um executável do Windows.
