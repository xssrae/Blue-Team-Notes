---
tags:
  - MALWARE-ANALISYS
  - LetsDefend
---
Primeiro, vamos descobrir as informações do empacotador com a ferramenta **"CFF Explorer":**

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff1.png)

Como pode ser visto na imagem acima, o nome do empacotador "UPX" está escrito na seção "Informações do arquivo". As seções do arquivo executável também são as seguintes:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff2.png)

A imagem acima exibe os nomes das seções do empacotador UPX. Através da análise das seções **"Informações de Arquivo"** e **"Seção",** concluiu-se que o malware em questão foi embalado com o pacote UPX.

Uma vez que o empacotador usado tenha sido identificado, o próximo passo é descompactar o arquivo executável usando a ferramenta apropriada. No caso do UPX packer, uma vez que é um empacotador de código aberto, a ferramenta necessária para descompactar está prontamente disponível na internet. Você pode acessar a ferramenta no seguinte endereço:

**UPX** : [https://upx.github.io/](https://upx.github.io/)

**Nota:** Se um empacotador diferente foi usado e nenhuma ferramenta de descompacte prontamente disponível, o processo de descompactar envolveria escrever código de descompactamento personalizado ou utilizar ferramentas de engenharia reversa dinâmica para analisar o arquivo executável e extrair a versão descompactada.

A ferramenta "CFF Explorer" inclui um desempacotamento UPX em si, que permite desempacotar rápido e eficiente diretamente da seção "UPX Utility".

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff3.png)


Depois que o arquivo executável foi descompactado usando o botão "Despachar" visto na imagem acima, o campo "Informações de arquivo" no menu "Arquivo" à esquerda é verificado.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff4.png)

Como descrito na imagem, o campo que anteriormente exibia "UPX" não indica mais a presença de UPX após o processo de descompacotamento. Essa alteração significa que o arquivo executável foi descompactado com sucesso. As seções do arquivo executável descompactado são analisadas e examinadas:

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff5.png)

Como é evidente a partir da imagem, as seções do arquivo executável do Windows desempacotado aparecem no arranjo esperado, assemelhando-se a um executável típico descompactado. Isso indica que a operação de desembaloamento foi realizada com sucesso.

O arquivo executável descompactado através do CFF Explorer não é salvo como um arquivo separado dentro do sistema. Se o programa estiver fechado, o processo de descompactar precisa ser repetido no arquivo. No entanto, é possível exportar e salvar o arquivo executável descompactado usando o CFF Explorer. Para salvar o arquivo descompactado, os passos "Arquivo - Salvar como" devem ser seguidos no menu superior.

![](https://letsdefend-images.s3.us-east-2.amazonaws.com/Courses/Static-Malware-Analysis/5.Unpacking+Packed+Malware/cff6.png)

Se as etapas na imagem acima forem aplicadas, a versão descomplicada do arquivo executável será salva.
