---
tags:
  - MALWARE-ANALISYS
  - Rangeforce
---
Neste módulo, você analisará uma amostra de malware usando o pestudio para análise estática e o ProcDOT para análise dinâmica.

---
# Identificando o malware
A análise com o **pestudio** revelou vários indicadores de que a amostra de malware é suspeita, incluindo uma data de compilação do ano 2093, o que é estranho.

Quando você encontra um arquivo suspeito, é uma boa ideia analisá-lo com ferramentas de análise de malware on-line, como o **VirusTotal** ou o **Joe Sandbox**, para ver se aparece alguma coisa.

==Com certeza, uma busca pelo hash do binário no Joe Sandbox confirma que o binário é malicioso e faz parte da família de malware **AsyncRAT**.==

>O AsyncRAT é uma ferramenta de administração remota (RAT) de código aberto projetada para controlar outros computadores remotamente, fornecendo controle remoto da área de trabalho, keylogging, upload/download de arquivos, execução de comandos e vários outros recursos. O aplicativo de servidor do AsyncRAT é executado em um servidor que atua como comando e controle (C2) e escuta nas portas tcp/6606 , tcp/7707 e tcp/8808 por padrão. O aplicativo vem com um construtor de clientes que é usado para criar binários e personalizar recursos conforme necessário. Embora o AsyncRAT não tenha sido criado para uso mal-intencionado, muitos agentes de ameaças utilizam essa ferramenta para criar binários que dão controle total sobre o sistema depois de executados.


---
# Processos gerados
O malware foi executado em um host isolado, onde a atividade do processo e o tráfego de rede foram capturados. As capturas podem ser encontradas no diretório behavior-data em sua pasta Desktop.

Para investigar o malware, inicie o ProcDOT, carregue os arquivos de captura, selecione o primeiro processo de invoice.exe que aparecer e gere o gráfico.

Agora que você gerou o gráfico do invoice.exe no ProcDOT, investigue o primeiro processo iniciado pelo malware:
![[Pasted image 20240213184358.png]]
Você pode encontrar o caminho do executável clicando com o botão direito do mouse no nó do gráfico do processo e indo para Detalhes. Em seguida, investigue o gráfico para encontrar um processo que foi iniciado e continuou em execução após a captura.

O nó do gráfico a seguir representa os processos que permaneceram ativos após o monitoramento:

![[Pasted image 20240213184447.png]]

---
# Persistência
Os clientes AsyncRAT são normalmente configurados para estabelecer a persistência por meio da autocópia em um diretório separado e da configuração da inicialização automática na inicialização do sistema. Investigue o gráfico em busca de arquivos descartados e modificações no registro.

Os nós do gráfico a seguir representam arquivos descartados e modificações no registro:
![[Pasted image 20240213184554.png]]

Uma entrada em `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\` significa que um aplicativo foi definido para ser executado automaticamente na inicialização, o que parece ser a maneira pela qual esse malware permite a inicialização automática.

---
# Comunicações com o C2
Quando o AsyncRAT termina a fase de configuração, ele estabelece conexões com um servidor C2 para permitir o controle remoto. Investigue as comunicações de rede para identificar o servidor C2.

No gráfico, os servidores são representados pelo seguinte nó:

![[Pasted image 20240213184654.png]]

