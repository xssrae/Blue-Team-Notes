---
tags:
  - MALWARE-ANALISYS
  - Rangeforce
---
# Introdução
O aumento das ameaças cibernéticas impôs uma carga significativa sobre as equipes de Segurança Operacional (SOC) e de resposta a incidentes nas organizações. A detecção de arquivos suspeitos demanda análise minuciosa para determinar seu caráter malicioso. A engenharia reversa e a análise de comportamento interativo são tarefas demoradas, exigindo habilidades especializadas. 

Contudo, a análise de malware totalmente automatizada surge como uma solução, realizando propriedades estáticas e análise comportamental em amostras, identificando possíveis consequências, gerando relatórios e extraindo indicadores de comprometimento (IoCs). Essa abordagem visa acelerar o processo e aliviar a sobrecarga nas equipes de segurança. As ferramentas de análise automatizada, essencialmente sandboxes, executam essas tarefas de forma eficiente, permitindo o processamento em grande escala de arquivos potencialmente maliciosos.

A máquina host gerencia a interface do usuário, a máquina convidada, o gerenciamento da análise e a geração de relatórios, enquanto as máquinas convidadas (VMs) atuam como ambientes seguros para executar e observar o comportamento do malware. O resultado final é um processo eficaz de análise que contribui para aprimorar os sistemas de detecção/proteção.

![Basic analysis tool diagram](https://cdn.rangeforce.com/modules/XCBFG3xq6XkV069Uf/PMWLKTx9HxgjkmDn5.png "Basic analysis tool diagram")  

# Soluções
Há inúmeras soluções de análise de malware totalmente automatizadas disponíveis na Internet. A maioria delas suporta os mesmos recursos básicos, como extração de strings, URLs, captura de tráfego de rede, listagem e exportação de arquivos criados/editados, listagem de modificações no registro, processos gerados, chamadas de API do Windows etc. No entanto, eles também podem variar muito em escala, integrações suportadas, grupos de clientes-alvo, outros recursos, etc. Cabe a você analisar e escolher a ferramenta correta para o seu aplicativo.

Aqui estão alguns exemplos de soluções disponíveis para você começar:
- [**Hybrid Analysis**](https://www.hybrid-analysis.com/)
- [**Falcon Sandbox**](https://www.crowdstrike.com/endpoint-security-products/falcon-sandbox-malware-analysis/)
- [**ANY.RUN**](https://any.run/)
- [**CAPE Sandbox**](https://capesandbox.com/)
- [**Cuckoo Sandbox**](https://cuckoosandbox.org/)

A lista acima mostra apenas algumas das ferramentas de análise de malware totalmente automatizadas disponíveis. Para ver mais opções, confira [**esta lista de sandboxes e serviços**](https://zeltser.com/automated-malware-analysis/) de **Lenny Zeltser**.
# Capacidades e limitações
A análise de malware totalmente automatizada é altamente benéfica para analistas e equipes de Segurança Operacional (SOC) devido a várias razões. Essas soluções oferecem rapidez e escalabilidade, permitindo a análise de milhares de amostras simultaneamente, sem exigir interação humana durante o processo. Além disso, a integração com outras ferramentas de SOC automatiza e impulsiona as operações. Isso reduz significativamente a carga de trabalho dos analistas, que podem se concentrar apenas em amostras suspeitas. Algumas soluções modernas incluem medidas antianálise e podem simular conexões com a Internet sem permitir comunicações reais. No entanto, essas ferramentas têm limitações, como a possibilidade de o malware operar de maneira diferente em ambientes distintos, a adaptação dos adversários para evitá-las e a dificuldade em simular interações humanas detalhadas, o que pode resultar em análises incompletas em certos casos.

---
# Caso de Estudo - Petya

O **Petya** é uma *família de malware de criptografia* descoberta pela primeira vez em 2016. O malware tem como alvo os sistemas baseados no Microsoft Windows. Quando instalado pela primeira vez, ==o ransomware Petya substitui o Master Boot Record (MBR) existente na unidade de inicialização por um carregador malicioso==. Em seguida, ele fará com que o Windows seja reiniciado para executar o novo carregador de ransomware malicioso, que exibirá uma tela fingindo ser o CHKDSK. Durante esse estágio falso do CHKDSK, o Petya criptografará a tabela de arquivos mestre na unidade.

O Petya e o NotPetya são duas peças de malware relacionadas que afetaram milhares de computadores em todo o mundo em 2016 e 2017. Tanto o Petya quanto o NotPetya têm como objetivo criptografar o disco rígido dos computadores infectados.

Há características comuns suficientes entre os dois que o NotPetya foi inicialmente visto como apenas uma variação de um tema. O ==**Notpetya** se espalha em um computador por conta própria==, enquanto o ==**Petya** exige que a vítima abra o arquivo e faça o download==. O Petya geralmente vem com um anexo em um e-mail e entra no computador assim que ele é aberto. O Notpetya não requer a intervenção de humanos para ser explorado.

Os ataques do NotPetya foram explicitamente direcionados a organizações localizadas na Ucrânia ou àquelas com laços comerciais estreitos com o país. Eventualmente, ele afetou organizações em quase 65 países, incluindo Estados Unidos, Reino Unido, Dinamarca, Índia e Austrália. Acredita-se que tenha causado bilhões de dólares em prejuízos. 

>Embora o NotPetya fosse tecnicamente um ransomware, ele foi quase inteiramente usado para destruir dados e interromper operações, e muito menos para coletar pagamentos de resgate das organizações afetadas.
