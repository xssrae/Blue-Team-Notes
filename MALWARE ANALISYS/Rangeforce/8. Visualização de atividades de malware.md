---
tags:
  - MALWARE-ANALISYS
  - Rangeforce
---
O **Process Monitor** e o **Wireshark** ou qualquer outra ferramenta de captura de tráfego de rede podem coletar uma grande quantidade de informações. Isso pode ser muito útil para a análise comportamental interativa. 

Entretanto, analisá-los separadamente e correlacionar os eventos pode ser entediante. É aí que entra o **ProcDOT**, uma ferramenta visual de análise de malware que combina dados do Procmon e do PCAP e converte milhares de atividades monitoradas em um gráfico interativo que pode ser explorado sem esforço.

---
# Introdução ao ProcDOT
O [ProcDOT](https://www.procdot.com/onlinedocumentation.htm) é uma ferramenta de análise visual de malware desenvolvida por Christian Wojner e pela nic.at GmbH. Ela mescla dados de processo gerados pelo Procmon e dados de tráfego de rede capturados em um gráfico apresentável que pode ser explorado de forma interativa.

![[Pasted image 20240213123950.png]]

![[Pasted image 20240213124005.png]]
## Uso do ProcDOT
Se você não estiver familiarizado com o uso do ProcDOT, aqui estão os princípios básicos:

Ampliação do gráfico: Use Ctrl + roda do mouse para ampliar o gráfico.
Legenda do gráfico: Pressione a tecla F1 para exibir a legenda do gráfico, que documenta nós e bordas.
Localizar texto: Você pode pesquisar cadeias de caracteres no gráfico pressionando Ctrl + F.

## Visualizar atividades
Inicie a ferramenta ProcDOT clicando no atalho colocado em sua área de trabalho.

![[Pasted image 20240213135619.png]]
Depois que a ferramenta for iniciada, siga as etapas abaixo para visualizar os dados:

### 1. Especifique o arquivo de registro do Procmon:
Clique no botão alt text e navegue até o diretório onde está o arquivo de dados `procmon.csv` do Procmon.

### 2. Especifique o arquivo de registro do Windump:
Clique no botão de texto alternativo e selecione o arquivo Wireshark `net-traffic.pcap` 

### 3. Selecione o processo que deseja analisar:
Clique no botão de texto alternativo e aguarde até que o ProcDOT termine de analisar o arquivo Procmon.

Quando isso for feito, será exibido um menu com os processos.
![[Pasted image 20240213135715.png]]

Como você está interessado no sys-maintenance.exe, selecione o primeiro processo que aparece, conforme destacado na imagem acima.

### 4. Gerar gráfico:

Agora que você especificou os arquivos necessários e o processo que deseja investigar, clique no botão Atualizar para gerar o gráfico.
![[Pasted image 20240213135827.png]]

---
## Comunicação com o Command Control
É comum que o malware se comunique com um servidor de Comando e Controle (C2) para receber comandos. Observando o gráfico, parece que o processo sys-maintenance.exe com o ID 5884 se comunica com três servidores, conforme observado pelos nós do círculo azul.

![[Pasted image 20240213144400.png]]

A julgar pelos nomes de domínio, os domínios tools.keycdn.com e api.ipify.org provavelmente são usados para outros fins. No entanto, o primeiro servidor parece ser o servidor C2.

---
# Persistência do malware
De acordo com o gráfico, parece que o sys-maintenance.exe gerou dois processos do schtasks.exe.

- Processo schtasks.exe gerado com ID 7308:
![[Pasted image 20240213144454.png]]- Gerou o processo schtasks.exe com ID 4916:

![[Pasted image 20240213144507.png]]
O processo schtasks.exe indica que o Agendador de Tarefas foi iniciado, permitindo que os usuários do Windows consultem, criem, excluam e modifiquem tarefas agendadas. Isso sugere que o malware pode ter estabelecido a persistência adicionando uma tarefa agendada para ser executada após a inicialização - uma técnica conhecida como [T1053](https://attack.mitre.org/techniques/T1053/) na base de conhecimento MITRE ATT&CK®.
